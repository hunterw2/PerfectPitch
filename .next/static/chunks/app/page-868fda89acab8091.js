(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6788:function(e,t,r){Promise.resolve().then(r.bind(r,5857))},5857:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var i=r(7437),o=r(2265);let n={easy:"rgba(56,189,248,.25)",medium:"rgba(250,204,21,.25)",hard:"rgba(248,113,113,.25)"},l={you:"#3b82f6",doc:"#475569"},s=e=>"pharma"===e?"Provider":"Prospect";function a(e){if(!e)return[];let t=e.split(/\n|•|-\s|;\s|\. (?=[A-Z(])/g).map(e=>e.trim().replace(/^[•-\s]+/,"")).filter(Boolean);return t.length?t:[e]}function d(e){return Math.max(0,Math.min(1,e))}function c(e){let{thinking:t,blink:r,viseme:o}=e,n=6+10*d(o),l=0+3*d(o),s=r?1:7;return(0,i.jsxs)("svg",{viewBox:"0 0 220 220",width:"220",height:"220",role:"img","aria-label":"Male avatar",children:[(0,i.jsxs)("defs",{children:[(0,i.jsxs)("radialGradient",{id:"skinM",cx:"50%",cy:"42%",r:"60%",children:[(0,i.jsx)("stop",{offset:"0%",stopColor:"#ffd7b8"}),(0,i.jsx)("stop",{offset:"100%",stopColor:"#eab799"})]}),(0,i.jsxs)("linearGradient",{id:"shirtM",x1:"0",x2:"1",children:[(0,i.jsx)("stop",{offset:"0%",stopColor:"#7aa8ff"}),(0,i.jsx)("stop",{offset:"100%",stopColor:"#3d6cf0"})]}),(0,i.jsx)("filter",{id:"softShadowM",x:"-30%",y:"-30%",width:"160%",height:"160%",children:(0,i.jsx)("feDropShadow",{dx:"0",dy:"8",stdDeviation:"8",floodColor:"rgba(0,0,0,.35)"})})]}),(0,i.jsxs)("g",{filter:"url(#softShadowM)",children:[(0,i.jsx)("rect",{x:"95",y:"135",width:"30",height:"20",rx:"8",fill:"url(#skinM)"}),(0,i.jsx)("circle",{cx:"110",cy:"105",r:"55",fill:"url(#skinM)"}),(0,i.jsx)("path",{d:"M55,100 Q65,45 110,45 Q155,45 165,100 Q150,80 110,75 Q70,80 55,100 Z",fill:"#3b3026"}),(0,i.jsx)("circle",{cx:"55",cy:"110",r:"9",fill:"#e5a98d"}),(0,i.jsx)("circle",{cx:"165",cy:"110",r:"9",fill:"#e5a98d"}),(0,i.jsx)("ellipse",{cx:"92",cy:"105",rx:"10",ry:s,fill:"#fff"}),(0,i.jsx)("ellipse",{cx:"128",cy:"105",rx:"10",ry:s,fill:"#fff"}),(0,i.jsx)("circle",{cx:"92",cy:"105",r:s>2?3.2:0,fill:"#222"}),(0,i.jsx)("circle",{cx:"128",cy:"105",r:s>2?3.2:0,fill:"#222"}),(0,i.jsx)("path",{d:"M80,".concat(92-l," q12,-8 24,-2"),stroke:"#2a221d",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),(0,i.jsx)("path",{d:"M116,".concat(90-l," q15,-6 24,0"),stroke:"#2a221d",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),(0,i.jsx)("path",{d:"M92,".concat(128," q18,").concat(n," 36,0"),stroke:"#b06464",strokeWidth:"5",fill:"none",strokeLinecap:"round"}),(0,i.jsx)("path",{d:"M50,185 q60,-32 120,0 v15 h-120 z",fill:"url(#shirtM)"})]}),t&&(0,i.jsx)("rect",{x:"0",y:"0",width:"220",height:"220",fill:"transparent",children:(0,i.jsx)("animate",{attributeName:"opacity",from:"0.15",to:"0.35",dur:"1.6s",repeatCount:"indefinite"})})]})}function p(e){let{thinking:t,blink:r,viseme:o}=e,n=6+10*d(o),l=0+3*d(o),s=r?1:7;return(0,i.jsxs)("svg",{viewBox:"0 0 220 220",width:"220",height:"220",role:"img","aria-label":"Female avatar",children:[(0,i.jsxs)("defs",{children:[(0,i.jsxs)("radialGradient",{id:"skinF",cx:"50%",cy:"42%",r:"60%",children:[(0,i.jsx)("stop",{offset:"0%",stopColor:"#ffe0c8"}),(0,i.jsx)("stop",{offset:"100%",stopColor:"#f2bda0"})]}),(0,i.jsxs)("linearGradient",{id:"shirtF",x1:"0",x2:"1",children:[(0,i.jsx)("stop",{offset:"0%",stopColor:"#ff9fd1"}),(0,i.jsx)("stop",{offset:"100%",stopColor:"#ff6fb8"})]}),(0,i.jsx)("filter",{id:"softShadowF",x:"-30%",y:"-30%",width:"160%",height:"160%",children:(0,i.jsx)("feDropShadow",{dx:"0",dy:"8",stdDeviation:"8",floodColor:"rgba(0,0,0,.35)"})})]}),(0,i.jsxs)("g",{filter:"url(#softShadowF)",children:[(0,i.jsx)("rect",{x:"95",y:"135",width:"30",height:"20",rx:"8",fill:"url(#skinF)"}),(0,i.jsx)("circle",{cx:"110",cy:"105",r:"55",fill:"url(#skinF)"}),(0,i.jsx)("path",{d:"M55,95 q5,-48 55,-52 q50,4 55,52 v35 q-15,25 -55,28 q-40,-3 -55,-28 z",fill:"#ffcc66"}),(0,i.jsx)("path",{d:"M55,96 q22,-28 55,-30 q33,2 55,30 q-20,-15 -55,-16 q-35,1 -55,16 z",fill:"#ffcf70"}),(0,i.jsx)("circle",{cx:"55",cy:"110",r:"8.5",fill:"#f2b9a0"}),(0,i.jsx)("circle",{cx:"165",cy:"110",r:"8.5",fill:"#f2b9a0"}),(0,i.jsx)("ellipse",{cx:"92",cy:"108",rx:"10",ry:s,fill:"#fff"}),(0,i.jsx)("ellipse",{cx:"128",cy:"108",rx:"10",ry:s,fill:"#fff"}),(0,i.jsx)("circle",{cx:"92",cy:"108",r:s>2?3:0,fill:"#222"}),(0,i.jsx)("circle",{cx:"128",cy:"108",r:s>2?3:0,fill:"#222"}),s>2&&(0,i.jsx)("path",{d:"M83,102 l-6,-3 M99,102 l6,-3 M119,102 l6,-3 M135,102 l6,-3",stroke:"#222",strokeWidth:"1.5"}),(0,i.jsx)("path",{d:"M80,".concat(95-l," q12,-7 24,-2"),stroke:"#a86b2a",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),(0,i.jsx)("path",{d:"M116,".concat(94-l," q15,-5 24,0"),stroke:"#a86b2a",strokeWidth:"4",fill:"none",strokeLinecap:"round"}),(0,i.jsx)("path",{d:"M92,130 q18,".concat(n," 36,0"),stroke:"#e23a77",strokeWidth:"6",fill:"none",strokeLinecap:"round"}),(0,i.jsx)("path",{d:"M50,185 q60,-32 120,0 v15 h-120 z",fill:"url(#shirtF)"})]}),t&&(0,i.jsx)("rect",{x:"0",y:"0",width:"220",height:"220",fill:"transparent",children:(0,i.jsx)("animate",{attributeName:"opacity",from:"0.15",to:"0.35",dur:"1.6s",repeatCount:"indefinite"})})]})}let u="dsim_runs_v4",f="dsim_history_v4";function h(){try{let e=localStorage.getItem(u);return e?JSON.parse(e):[]}catch(e){return[]}}function x(e){let t=h();t.push(e),localStorage.setItem(u,JSON.stringify(t.slice(-200)))}function g(){try{let e=localStorage.getItem(f);return e?JSON.parse(e):[]}catch(e){return[]}}function y(e){let t=g();t.push(e),localStorage.setItem(f,JSON.stringify(t.slice(-50)))}function b(){let[e,t]=(0,o.useState)({vertical:"door2door",difficulty:"easy",tone:"matter-of-fact",product:"pen",persona:"Homeowner, cost-conscious but open to value"}),[r,d]=(0,o.useState)("chat"),[b,m]=(0,o.useState)("male"),[v,j]=(0,o.useState)([]),[w,k]=(0,o.useState)(""),[S,C]=(0,o.useState)(""),[R,M]=(0,o.useState)(!1),[T,z]=(0,o.useState)(null),[I,_]=(0,o.useState)(!1),E=h(),W=(0,o.useMemo)(()=>E.slice().sort((e,t)=>t.score-e.score).slice(0,10),[E.length]),L=(0,o.useRef)(null),N=(0,o.useRef)(!1),[O,P]=(0,o.useState)(!1),[B,q]=(0,o.useState)(!0),[D,F]=(0,o.useState)(!1),[H,G]=(0,o.useState)(!1),[U,V]=(0,o.useState)(0),[A,J]=(0,o.useState)(!1),[K,Q]=(0,o.useState)(!1),[Y,Z]=(0,o.useState)(!1);function $(){if(L.current){try{L.current.onresult=null,L.current.onend=null,L.current.onerror=null,L.current.stop()}catch(e){}L.current=null}P(!1)}function X(){if(D||K||D||N.current)return;let e=function(){let e=window,t=e.SpeechRecognition||e.webkitSpeechRecognition||e.mozSpeechRecognition;if(!t)return null;let r=new t;return r.lang="en-US",r.interimResults=!0,r.continuous=!0,r.maxAlternatives=1,r}();if(!e){alert("Speech Recognition not supported in this browser. Try Chrome on desktop.");return}L.current=e,P(!0),C("");let t="",r=null;e.onresult=e=>{for(let i=e.resultIndex;i<e.results.length;i++){if(D)return;let o=e.results[i],n=o[0].transcript;o.isFinal?(t=(t+" "+n).trim(),C(""),B?(r&&(clearTimeout(r),r=null),r=window.setTimeout(()=>{let e=t.trim();t="",e&&ei(e)},900)):k(e=>e?"".concat(e," ").concat(n.trim()):n.trim())):C(n)}},e.onend=()=>{P(!1)},e.onerror=()=>P(!1);try{e.start()}catch(e){}}async function ee(t){var r,i;let o=await fetch("/api/sim",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scenario:e,messages:t})});if(!o.ok)return"Sorry—could you restate that?";let n=await o.json(),l=null!==(i=null!==(r=n.text)&&void 0!==r?r:n.reply)&&void 0!==i?i:"Understood.";return"pharma"!==e.vertical&&/\b(coverage|covered|insurance|payer|formulary|prior ?auth|authorization)\b/i.test(l)&&(l="Got it—let’s stick to the essentials for now."),l}async function et(t){try{var r,i,o,n,l;let a=await fetch("/api/score",{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-store",body:JSON.stringify({scenario:e,messages:t,transcript:t.map(t=>"".concat("you"===t.who?"Rep":s(e.vertical),": ").concat(t.text)).join("\n")})});if(!a.ok)throw Error("Score API not ok");let d=await a.json(),c=Number.isFinite(null==d?void 0:d.score)?Math.round(10*Number(d.score))/10:6.5,p={score:c,wentWell:(null!==(i=null!==(r=null==d?void 0:d.wentWell)&&void 0!==r?r:null==d?void 0:d.good)&&void 0!==i?i:"").trim(),improve:(null!==(o=null==d?void 0:d.improve)&&void 0!==o?o:"").trim(),next:(null!==(l=null!==(n=null==d?void 0:d.next)&&void 0!==n?n:null==d?void 0:d.nextTime)&&void 0!==l?l:"").trim()};z(p),x({ts:Date.now(),score:p.score,vertical:e.vertical,difficulty:e.difficulty,product:e.product,tone:e.tone,persona:e.persona}),y(t)}catch(s){let r;let i=t.filter(e=>"you"===e.who).map(e=>e.text).join(" "),o=t.filter(e=>"doc"===e.who).map(e=>e.text).join(" "),n=(i.match(/\?/g)||[]).length,l=(o.match(/price|expensive|budget|time|busy|coverage|insurance|prior\s*auth|risk|not\s*interested|send\s+info/gi)||[]).length;z({score:r=Math.round(10*(r=Math.max(0,Math.min(10,r=5+Math.min(.35*n,2)-Math.min(.4*l,1.2)+(Math.random()-.5)*.5))))/10,wentWell:n>=2?"Strong discovery and natural flow.":"Good rapport; add 1–2 sharper discovery questions.",improve:l>0?"Tighten objection handling with one-sentence answers.":"Translate features into outcomes tied to the persona.",next:"Propose a crisp next step and a concrete time."}),x({ts:Date.now(),score:r,vertical:e.vertical,difficulty:e.difficulty,product:e.product,tone:e.tone,persona:e.persona}),y(t)}}async function er(t){var i,o,n;let l=await ee(t);o=e.vertical,n=l,"pharma"!==o&&(n=n.replace(/\b(insurance|coverage|copay|prior authorization)\b/gi,"options")),l=n;let s=(null===(i=[...t].reverse().find(e=>"doc"===e.who))||void 0===i?void 0:i.text)||"";s&&s.trim().toLowerCase()===l.trim().toLowerCase()&&(l="Makes sense—what would you need from me to get this started?"),j(e=>[...e,{who:"doc",text:l}]),"avatar"===r&&function t(r){if(!r||K||D)return;if($(),P(!1),!Y){setTimeout(()=>t(r),120);return}N.current=!0,O&&$(),N.current=!0;let i=new SpeechSynthesisUtterance(r);i.voice=function(e,t){var r;let i=window.speechSynthesis.getVoices()||[],o="female"===t?["Google UK English Female","Google US English","Samantha","Victoria","Karen"]:["Google UK English Male","Google US English","Alex","Daniel","Fred"];for(let e of o){let t=i.find(t=>t.name.includes(e));if(t)return t}let n=i.find(e=>"female"===t?/female/i.test(e.name):/male/i.test(e.name));return n||(null!==(r=i.find(e=>{var t;return(null===(t=e.lang)||void 0===t?void 0:t.toLowerCase())==="en-us"}))&&void 0!==r?r:i[0])}(e.tone,b);let o=e.tone.toLowerCase();i.rate=o.includes("fast")?1.12:o.includes("calm")?.96:1.02,i.pitch="female"===b?1.06:.98,i.volume=1,i.onstart=()=>{G(!0),V(.1)},i.onend=()=>{G(!1),V(0),N.current=!1,(B||O)&&!D&&!K&&setTimeout(()=>X(),600)},i.onboundary=()=>{V(.35+.55*Math.random()),setTimeout(()=>V(e=>.25*e),90)},window.speechSynthesis.cancel(),window.speechSynthesis.speak(i)}(l)}async function ei(e){if(K)return;let t=e.trim();t&&(k(""),C(""),j(e=>[...e,{who:"you",text:t}]),await er([...v,{who:"you",text:t}]))}async function eo(){await ei(w)}async function en(){!function(){try{var e,t;null===(t=window.recognition)||void 0===t||null===(e=t.stop)||void 0===e||e.call(t)}catch(e){}}(),M(!0),Q(!0),$(),window.speechSynthesis.cancel(),G(!1),V(0),C(""),await et(v)}(0,o.useEffect)(()=>{let e=document.getElementById("chatScroll");e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})},[v.length]),(0,o.useEffect)(()=>{D&&($(),P(!1),q(!1))},[D]),(0,o.useEffect)(()=>{let e=setInterval(()=>{J(!0),setTimeout(()=>J(!1),120)},3600+1200*Math.random());return()=>clearInterval(e)},[]),(0,o.useEffect)(()=>{let e=()=>Z(!0);try{var t,r;null===(t=(r=window.speechSynthesis).addEventListener)||void 0===t||t.call(r,"voiceschanged",e)}catch(e){}let i=setTimeout(()=>Z(!0),400);return()=>{clearTimeout(i);try{var t,r;null===(t=(r=window.speechSynthesis).removeEventListener)||void 0===t||t.call(r,"voiceschanged",e)}catch(e){}}},[]),(0,o.useEffect)(()=>{j([]),z(null),Q(!1)},[e.vertical,e.difficulty,e.product,e.persona]);let el=s(e.vertical),es=n[e.difficulty];return(0,i.jsxs)("div",{style:{minHeight:"100vh",background:"#0b1220",color:"#e5ecff"},children:[(0,i.jsxs)("div",{style:{maxWidth:1100,margin:"0 auto",padding:"28px 20px"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:14},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,i.jsx)("img",{src:"/logo.png",alt:"PerfectPitch Logo",style:{width:100,height:100,borderRadius:15}}),(0,i.jsx)("h1",{style:{fontSize:28,fontWeight:700,letterSpacing:.4},children:"PerfectPitch"})]}),"          ",(0,i.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,i.jsx)("button",{onClick:()=>_(!0),style:{padding:"8px 12px",borderRadius:10,background:"#22c55e22",border:"1px solid #22c55e55",color:"#bbf7d0",cursor:"pointer"},children:"History & Leaderboard"}),(0,i.jsxs)("div",{style:{background:"#0f172a",border:"1px solid #273754",borderRadius:999,padding:4,display:"flex",gap:4},children:[(0,i.jsx)("button",{onClick:()=>d("chat"),style:{padding:"6px 12px",borderRadius:999,border:"none",cursor:"pointer",color:"chat"===r?"#0b1220":"#93a9cd",background:"chat"===r?"#5eead4":"transparent"},children:"Chat"}),(0,i.jsx)("button",{onClick:()=>d("avatar"),style:{padding:"6px 12px",borderRadius:999,border:"none",cursor:"pointer",color:"avatar"===r?"#0b1220":"#93a9cd",background:"avatar"===r?"#5eead4":"transparent"},children:"Avatar"})]})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, minmax(0,1fr))",gap:12,marginBottom:16},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:12,opacity:.7},children:"Vertical"}),(0,i.jsxs)("select",{value:e.vertical,onChange:e=>t(t=>({...t,vertical:e.target.value})),style:{width:"100%",background:"#0f172a",color:"#e5ecff",borderRadius:8,padding:8,border:"1px solid #273754"},children:[(0,i.jsx)("option",{value:"door2door",children:"Door-to-Door"}),(0,i.jsx)("option",{value:"b2b",children:"B2B"}),(0,i.jsx)("option",{value:"pharma",children:"Pharma (HCP)"}),(0,i.jsx)("option",{value:"tech",children:"Tech"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:12,opacity:.7},children:"Difficulty"}),(0,i.jsxs)("select",{value:e.difficulty,onChange:e=>t(t=>({...t,difficulty:e.target.value})),style:{width:"100%",background:"#0f172a",color:"#e5ecff",borderRadius:8,padding:8,border:"1px solid #273754"},children:[(0,i.jsx)("option",{children:"easy"}),(0,i.jsx)("option",{children:"medium"}),(0,i.jsx)("option",{children:"hard"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:12,opacity:.7},children:"Tone"}),(0,i.jsx)("input",{value:e.tone,onChange:e=>t(t=>({...t,tone:e.target.value})),placeholder:"matter-of-fact",style:{width:"100%",background:"#0f172a",color:"#e5ecff",borderRadius:8,padding:8,border:"1px solid #273754"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:12,opacity:.7},children:"Product/Offer"}),(0,i.jsx)("input",{value:e.product,onChange:e=>t(t=>({...t,product:e.target.value})),placeholder:"pen",style:{width:"100%",background:"#0f172a",color:"#e5ecff",borderRadius:8,padding:8,border:"1px solid #273754"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:12,opacity:.7},children:"Persona"}),(0,i.jsx)("input",{value:e.persona,onChange:e=>t(t=>({...t,persona:e.target.value})),placeholder:"Homeowner…",style:{width:"100%",background:"#0f172a",color:"#e5ecff",borderRadius:8,padding:8,border:"1px solid #273754"}})]})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[(0,i.jsx)("button",{onClick:()=>O?$():X(),disabled:D,style:{padding:"8px 12px",borderRadius:10,background:D?"#334155":O?"#ef4444":"#22c55e",border:"1px solid rgba(255,255,255,.15)",color:"#0b1220",cursor:D?"not-allowed":"pointer",fontWeight:600,opacity:D?.6:1},children:D?"Text Only":O?"Stop Voice":"Start Voice"}),(0,i.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8,fontSize:14,opacity:.9},children:[(0,i.jsx)("input",{type:"checkbox",checked:B,onChange:e=>q(e.target.checked),disabled:K||D}),"Hands-free (auto-send)"]}),(0,i.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8,fontSize:14,opacity:.9},children:[(0,i.jsx)("input",{type:"checkbox",checked:D,onChange:e=>F(e.target.checked)}),"Text Only (no mic)"]}),"avatar"===r&&(0,i.jsxs)("div",{style:{marginLeft:"auto",background:"#0f172a",border:"1px solid #273754",borderRadius:999,padding:4,display:"flex",gap:4},children:[(0,i.jsx)("button",{onClick:()=>m("male"),style:{padding:"6px 12px",borderRadius:999,border:"none",cursor:"pointer",color:"male"===b?"#0b1220":"#93a9cd",background:"male"===b?"#60a5fa":"transparent"},children:"Male"}),(0,i.jsx)("button",{onClick:()=>m("female"),style:{padding:"6px 12px",borderRadius:999,border:"none",cursor:"pointer",color:"female"===b?"#0b1220":"#93a9cd",background:"female"===b?"#f472b6":"transparent"},children:"Female"})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"chat"===r?"1fr":"1fr 360px",gap:16,transition:"grid-template-columns .25s ease"},children:[(0,i.jsxs)("div",{style:{background:"linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01))",border:"1px solid #1f2a44",borderRadius:16,padding:14},children:[(0,i.jsx)("div",{style:{fontSize:13,opacity:.7,marginBottom:6},children:el}),(0,i.jsxs)("div",{id:"chatScroll",style:{maxHeight:430,overflowY:"auto",display:"flex",flexDirection:"column",gap:10,padding:8,background:"#0b1220",borderRadius:14,border:"1px solid #17223b"},children:[v.map((e,t)=>(0,i.jsx)("div",{style:{display:"flex",justifyContent:"you"===e.who?"flex-end":"flex-start"},children:(0,i.jsxs)("div",{style:{maxWidth:"72%",background:"you"===e.who?l.you:l.doc,color:"#eaf1ff",padding:"10px 12px",borderRadius:16,borderTopLeftRadius:"you"===e.who?16:6,borderTopRightRadius:"you"===e.who?6:16,boxShadow:"0 2px 0 0 rgba(0,0,0,.25), inset 0 0 0 1000px ".concat(es),lineHeight:1.35,whiteSpace:"pre-wrap"},children:[(0,i.jsx)("div",{style:{fontSize:12,opacity:.8,marginBottom:4},children:"you"===e.who?"You":el}),e.text]})},t)),S&&(0,i.jsxs)("div",{style:{opacity:.6,fontStyle:"italic",paddingLeft:6},children:["…",S]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:10,marginTop:10},children:[(0,i.jsx)("input",{value:w,onChange:e=>k(e.target.value),onKeyDown:e=>{K||"Enter"!==e.key||e.shiftKey||(e.preventDefault(),eo())},placeholder:"Speak or type your next line…",style:{flex:1,background:"#0f172a",color:"#e5ecff",borderRadius:10,padding:"10px 12px",border:"1px solid #273754",outline:"none"},disabled:K}),(0,i.jsx)("button",{onClick:eo,disabled:K,style:{padding:"10px 14px",borderRadius:10,background:K?"#64748b":"#60a5fa",border:"1px solid rgba(255,255,255,.15)",color:"#0b1220",fontWeight:700,cursor:K?"not-allowed":"pointer"},children:"Send"}),(0,i.jsx)("button",{onClick:en,style:{padding:"10px 14px",borderRadius:10,background:"#22c55e",border:"1px solid rgba(255,255,255,.15)",color:"#0b1220",fontWeight:700,cursor:"pointer"},children:"End & Score"}),(0,i.jsx)("button",{onClick:function(){M(!1),function(){if(!D&&!R)try{var e,t;null===(t=window.recognition)||void 0===t||null===(e=t.start)||void 0===e||e.call(t)}catch(e){}}(),j([]),z(null),k(""),C(""),Q(!1),D||$()},style:{padding:"10px 14px",borderRadius:10,background:"#f59e0b",border:"1px solid rgba(255,255,255,.15)",color:"#0b1220",fontWeight:700,cursor:"pointer"},children:"Start New"})]}),T&&(0,i.jsxs)("div",{style:{marginTop:12,borderRadius:14,border:"1px solid #1f2a44",padding:12,background:"#0f172a"},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:8},children:[(0,i.jsx)("div",{style:{fontWeight:700},children:"Score:"}),(0,i.jsxs)("div",{style:{padding:"4px 10px",borderRadius:999,background:"#22c55e22",border:"1px solid #22c55e55",color:"#bbf7d0",fontWeight:700},children:[Number(T.score).toFixed(1)," / 10"]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3,minmax(0,1fr))",gap:12},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:12,opacity:.7,marginBottom:6},children:"What went well"}),(0,i.jsx)("div",{style:{display:"grid",gap:6},children:a(T.wentWell||"—").map((e,t)=>(0,i.jsxs)("div",{style:{background:"#16a34a22",border:"1px solid #16a34a55",color:"#bbf7d0",padding:"6px 8px",borderRadius:10,fontSize:13},children:["• ",e]},t))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:12,opacity:.7,marginBottom:6},children:"Improvements"}),(0,i.jsx)("div",{style:{display:"grid",gap:6},children:a(T.improve||"—").map((e,t)=>(0,i.jsxs)("div",{style:{background:"#f59e0b22",border:"1px solid #f59e0b55",color:"#fde68a",padding:"6px 8px",borderRadius:10,fontSize:13},children:["• ",e]},t))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:12,opacity:.7,marginBottom:6},children:"Next time"}),(0,i.jsx)("div",{style:{display:"grid",gap:6},children:a(T.next||"Frame a crisp close and propose a time.").map((e,t)=>(0,i.jsxs)("div",{style:{background:"#60a5fa22",border:"1px solid #60a5fa55",color:"#bfdbfe",padding:"6px 8px",borderRadius:10,fontSize:13},children:["• ",e]},t))})]})]})]})]}),"avatar"===r&&(0,i.jsxs)("div",{style:{background:"linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01))",border:"1px solid #1f2a44",borderRadius:16,padding:14,display:"flex",flexDirection:"column",alignItems:"center",gap:10},children:[(0,i.jsx)("div",{style:{fontSize:13,opacity:.7,alignSelf:"flex-start"},children:el}),(0,i.jsx)("div",{style:{width:280,height:320,borderRadius:18,background:"#0b1220",border:"1px solid #17223b",display:"grid",placeItems:"center",padding:10,position:"relative"},children:"male"===b?(0,i.jsx)(c,{thinking:O&&!N.current,blink:A,viseme:H?U:0}):(0,i.jsx)(p,{thinking:O&&!N.current,blink:A,viseme:H?U:0})}),(0,i.jsx)("div",{style:{fontSize:12,opacity:.7},children:K?"Call ended":O?"Voice: listening":D?"Voice: disabled (text only)":"Voice: idle"})]})]})]}),I&&(0,i.jsx)("div",{onClick:()=>_(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"grid",placeItems:"center",zIndex:40},children:(0,i.jsxs)("div",{onClick:e=>e.stopPropagation(),style:{width:840,maxWidth:"92vw",maxHeight:"80vh",overflow:"auto",background:"#0f172a",border:"1px solid #1f2a44",borderRadius:16,padding:16,color:"#e5ecff",boxShadow:"0 20px 50px rgba(0,0,0,.45)"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,i.jsx)("h3",{style:{margin:0},children:"History & Leaderboard"}),(0,i.jsx)("button",{onClick:()=>_(!1),style:{background:"#17223b",color:"#cbd5e1",border:"1px solid #273754",borderRadius:8,padding:"6px 10px"},children:"Close"})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:12,opacity:.7,marginBottom:6},children:"Top 10"}),(0,i.jsxs)("div",{style:{display:"grid",gap:8},children:[W.map((e,t)=>(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"28px 1fr 64px",alignItems:"center",gap:10,background:"#0b1220",border:"1px solid #17223b",borderRadius:10,padding:"8px 10px"},children:[(0,i.jsxs)("div",{style:{opacity:.6},children:["#",t+1]}),(0,i.jsxs)("div",{style:{fontSize:13},children:[(0,i.jsx)("b",{children:Number(e.score).toFixed(1)})," — ",e.vertical," / ",e.difficulty," / ",e.product,(0,i.jsx)("div",{style:{fontSize:11,opacity:.7},children:new Date(e.ts).toLocaleString()})]}),(0,i.jsx)("div",{style:{fontSize:11,opacity:.7,textAlign:"right"},children:e.tone})]},t)),0===W.length&&(0,i.jsx)("div",{style:{opacity:.6},children:"No scores yet."})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:12,opacity:.7,marginBottom:6},children:"Recent Sessions"}),(0,i.jsx)("div",{style:{display:"grid",gap:8},children:g().slice().reverse().slice(0,8).map((t,r)=>(0,i.jsxs)("div",{style:{background:"#0b1220",border:"1px solid #17223b",borderRadius:10,padding:"8px 10px",fontSize:13},children:[t.slice(0,4).map((t,r)=>(0,i.jsxs)("div",{children:[(0,i.jsxs)("b",{children:["you"===t.who?"You":s(e.vertical),":"]})," ",t.text]},r)),t.length>4&&(0,i.jsx)("div",{style:{opacity:.6},children:"…"})]},r))})]})]}),(0,i.jsx)("div",{style:{marginTop:14,display:"flex",gap:8},children:(0,i.jsx)("button",{onClick:()=>{localStorage.removeItem(u),localStorage.removeItem(f),_(!1)},style:{background:"#ef4444",color:"#0b1220",padding:"8px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.15)",cursor:"pointer"},children:"Clear History"})})]})})]})}},622:function(e,t,r){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i=r(2265),o=Symbol.for("react.element"),n=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),l=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(e,t,r){var i,a={},d=null,c=null;for(i in void 0!==r&&(d=""+r),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)n.call(t,i)&&!s.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===a[i]&&(a[i]=t[i]);return{$$typeof:o,type:e,key:d,ref:c,props:a,_owner:l.current}}t.jsx=a,t.jsxs=a},7437:function(e,t,r){"use strict";e.exports=r(622)}},function(e){e.O(0,[971,596,744],function(){return e(e.s=6788)}),_N_E=e.O()}]);